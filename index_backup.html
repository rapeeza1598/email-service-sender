<!DOCTYPE html>
<html lang="th">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                    Roboto, "Helvetica Neue", Arial, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            }

            .container {
                background: #2c3e50;
                border-radius: 20px;
                padding: 40px;
                width: 100%;
                max-width: 500px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            }

            .header {
                text-align: center;
                margin-bottom: 30px;
            }

            .header h1 {
                color: #f1c40f;
                font-size: 24px;
                font-weight: 600;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            label {
                display: block;
                color: #ecf0f1;
                font-size: 14px;
                margin-bottom: 8px;
                font-weight: 500;
            }

            input[type="text"],
            input[type="date"],
            input[type="time"],
            input[type="number"],
            input[type="file"],
            textarea {
                width: 100%;
                padding: 12px 16px;
                background: #34495e;
                border: 2px solid #4a5f7a;
                border-radius: 8px;
                color: #ecf0f1;
                font-size: 14px;
                transition: all 0.3s ease;
            }

            input[type="text"]:focus,
            input[type="date"]:focus,
            input[type="time"]:focus,
            input[type="number"]:focus,
            textarea:focus {
                outline: none;
                border-color: #3498db;
                box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            }

            textarea {
                resize: vertical;
                min-height: 80px;
            }

            .file-input {
                position: relative;
                overflow: hidden;
                display: inline-block;
                width: 100%;
            }

            .file-input input[type="file"] {
                position: absolute;
                left: -9999px;
            }

            .file-input-label {
                display: block;
                padding: 12px 16px;
                background: #34495e;
                border: 2px solid #4a5f7a;
                border-radius: 8px;
                color: #bdc3c7;
                cursor: pointer;
                transition: all 0.3s ease;
                text-align: center;
            }

            .file-input-label:hover {
                background: #3c5a78;
                border-color: #3498db;
            }

            .file-list {
                margin-top: 10px;
            }

            .file-item {
                background: #34495e;
                border: 1px solid #4a5f7a;
                border-radius: 6px;
                padding: 8px 12px;
                margin: 5px 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                color: #ecf0f1;
                font-size: 14px;
            }

            .file-item .file-name {
                flex: 1;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }

            .file-item .file-size {
                color: #bdc3c7;
                font-size: 12px;
                margin-left: 10px;
            }

            .file-item .remove-file {
                background: #e74c3c;
                color: white;
                border: none;
                border-radius: 4px;
                padding: 4px 8px;
                cursor: pointer;
                font-size: 12px;
                margin-left: 10px;
            }

            .file-item .remove-file:hover {
                background: #c0392b;
            }

            .button-group {
                display: flex;
                gap: 15px;
                margin-top: 30px;
            }

            .btn {
                flex: 1;
                padding: 14px 20px;
                border: none;
                border-radius: 10px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }

            .btn-submit {
                background: #f1c40f;
                color: #2c3e50;
            }

            .btn-submit:hover {
                background: #f39c12;
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(241, 196, 15, 0.3);
            }

            .btn-cancel {
                background: #e74c3c;
                color: white;
            }

            .btn-cancel:hover {
                background: #c0392b;
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(231, 76, 60, 0.3);
            }

            .loading {
                display: none;
                text-align: center;
                color: #3498db;
                margin-top: 20px;
            }

            .response {
                margin-top: 20px;
                padding: 15px;
                border-radius: 8px;
                display: none;
            }

            .response.success {
                background: #27ae60;
                color: white;
            }

            .response.error {
                background: #e74c3c;
                color: white;
            }

            .initial-loading {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(44, 62, 80, 0.95);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                z-index: 9999;
            }

            .initial-loading .spinner {
                width: 50px;
                height: 50px;
                border: 4px solid #34495e;
                border-top: 4px solid #f1c40f;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-bottom: 20px;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            .initial-loading .text {
                color: #ecf0f1;
                font-size: 16px;
                text-align: center;
            }

            .existing-data-modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: none;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            }

            .modal-content {
                background: #2c3e50;
                padding: 30px;
                border-radius: 15px;
                max-width: 500px;
                width: 90%;
                text-align: center;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            }

            .modal-content h2 {
                color: #f1c40f;
                margin-bottom: 15px;
                font-size: 20px;
            }

            .modal-content p {
                color: #ecf0f1;
                margin-bottom: 20px;
                line-height: 1.6;
            }

            .existing-data-info {
                background: #34495e;
                padding: 15px;
                border-radius: 8px;
                margin: 20px 0;
                text-align: left;
            }

            .existing-data-info .info-item {
                color: #bdc3c7;
                margin-bottom: 8px;
            }

            .existing-data-info .info-item strong {
                color: #3498db;
            }

            .modal-buttons {
                display: flex;
                gap: 15px;
                justify-content: center;
            }

            .modal-btn {
                padding: 12px 25px;
                border: none;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .modal-btn.continue {
                background: #27ae60;
                color: white;
            }

            .modal-btn.continue:hover {
                background: #219a52;
            }

            .modal-btn.cancel {
                background: #e74c3c;
                color: white;
            }

            .modal-btn.cancel:hover {
                background: #c0392b;
            }

            @media (max-width: 600px) {
                .container {
                    padding: 30px 20px;
                }

                .button-group {
                    flex-direction: column;
                }
            }
        </style>
    </head>
    <body>
        <!-- Loading ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å -->
        <div class="initial-loading" id="initialLoading">
            <div class="spinner"></div>
            <div class="text">
                <div>üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                <div style="font-size: 14px; margin-top: 10px; color: #bdc3c7">
                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà
                </div>
            </div>
        </div>

        <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß -->
        <div class="existing-data-modal" id="existingDataModal">
            <div class="modal-content">
                <h2>‚ö†Ô∏è ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
                <p>
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Transaction ID
                    ‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                </p>

                <div class="existing-data-info" id="existingDataInfo">
                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>

                <p style="color: #f39c12; font-size: 14px">
                    ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
                </p>

                <div class="modal-buttons">
                    <button
                        class="modal-btn continue"
                        onclick="continueWithExistingData()"
                    >
                        ‚úì ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠
                    </button>
                    <button
                        class="modal-btn cancel"
                        onclick="cancelAndRedirect()"
                    >
                        ‚úó ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </div>
        </div>

        <div class="container" id="mainContainer" style="display: none">
            <div class="header">
                <h1>üí≥ ‡πÅ‡∏à‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h1>
            </div>

            <form id="paymentForm">
                <div class="form-group">
                    <label for="account">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</label>
                    <input
                        type="text"
                        id="account"
                        name="account"
                        placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ"
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="transactionId"
                        >Transaction ID / Order No.:</label
                    >
                    <input
                        type="text"
                        id="transactionId"
                        name="transactionId"
                        placeholder="DM13UWT9R4H7IF"
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="transferDate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</label>
                    <input
                        type="date"
                        id="transferDate"
                        name="transferDate"
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="transferTime">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</label>
                    <input
                        type="time"
                        id="transferTime"
                        name="transferTime"
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="recipientAccount">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤:</label>
                    <input
                        type="text"
                        id="recipientAccount"
                        name="recipientAccount"
                        placeholder="123-0987699"
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
                    <input
                        type="number"
                        id="amount"
                        name="amount"
                        placeholder="5000.00"
                        step="0.01"
                        required
                    />
                </div>

                <div class="form-group">
                    <label for="additional">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° / ‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</label>
                    <textarea
                        id="additional"
                        name="additional"
                        placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."
                    ></textarea>
                </div>

                <div class="form-group">
                    <label>üìé ‡πÅ‡∏ô‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô:</label>
                    <div class="file-input">
                        <input
                            type="file"
                            id="attachment"
                            name="attachment"
                            accept="image/*,.pdf,.doc,.docx"
                            multiple
                        />
                        <label
                            for="attachment"
                            class="file-input-label"
                            id="fileLabel"
                        >
                            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå ‡∏´‡∏£‡∏∑‡∏≠ ‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
                            (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)
                        </label>
                    </div>
                    <div id="fileList" class="file-list"></div>
                </div>

                <div class="button-group">
                    <button type="submit" class="btn btn-submit">
                        ‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                    </button>
                    <button
                        type="button"
                        class="btn btn-cancel"
                        onclick="resetForm()"
                    >
                        ‚úñÔ∏è ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                </div>
            </form>

            <div class="loading" id="loading">
                <div>üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
            </div>

            <div class="response" id="response"></div>
        </div>

        <script>
            // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            let formData = {}
            let attachmentFile = null
            let existingPaymentData = null
            let transactionId = null

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î
            document.addEventListener("DOMContentLoaded", function () {
                // ‡∏î‡∏∂‡∏á Transaction ID ‡∏à‡∏≤‡∏Å URL parameters
                const urlParams = new URLSearchParams(window.location.search)
                transactionId =
                    urlParams.get("transaction_id") || urlParams.get("order_no")

                if (transactionId) {
                    checkExistingTransaction(transactionId)
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ transaction ID ‡πÉ‡∏ô URL ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á ID ‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏™‡πà
                    showMainForm()
                }

                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå
                setupFileHandlers()
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
                setupFormSubmission()

                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                document.getElementById("transferDate").valueAsDate = new Date()
                const now = new Date()
                const timeString = now.toTimeString().slice(0, 5)
                document.getElementById("transferTime").value = timeString
            })

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
            function checkExistingTransaction(transactionId) {
                // ‡πÅ‡∏™‡∏î‡∏á loading
                document.getElementById("initialLoading").style.display = "flex"

                // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                setTimeout(() => {
                    // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å server)
                    const mockExistingData = {
                        transactionId: transactionId,
                        account: "‡∏ô‡∏≤‡∏¢ ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ",
                        transferDate: "2024-01-15",
                        transferTime: "14:30",
                        recipientAccount: "123-0987699",
                        amount: 5000.0,
                        additional: "‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤",
                        status: "‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö",
                        submittedDate: "2024-01-15 14:35:22",
                    }

                    // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (50% ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
                    const hasExistingData = Math.random() > 0.5

                    if (hasExistingData) {
                        existingPaymentData = mockExistingData
                        showExistingDataModal(mockExistingData)
                    } else {
                        showMainForm()
                    }
                }, 2000)
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
            function showExistingDataModal(data) {
                document.getElementById("initialLoading").style.display = "none"

                const infoDiv = document.getElementById("existingDataInfo")
                infoDiv.innerHTML = `
                <div class="info-item"><strong>Transaction ID:</strong> ${
                    data.transactionId
                }</div>
                <div class="info-item"><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> ${
                    data.account
                }</div>
                <div class="info-item"><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô:</strong> ${
                    data.transferDate
                }</div>
                <div class="info-item"><strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏≠‡∏ô:</strong> ${
                    data.transferTime
                }</div>
                <div class="info-item"><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${data.amount.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
                <div class="info-item"><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${
                    data.status
                }</div>
                <div class="info-item"><strong>‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠:</strong> ${
                    data.submittedDate
                }</div>
            `

                document.getElementById("existingDataModal").style.display =
                    "flex"
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
            function continueWithExistingData() {
                document.getElementById("existingDataModal").style.display =
                    "none"

                // ‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
                if (existingPaymentData) {
                    document.getElementById("account").value =
                        existingPaymentData.account
                    document.getElementById("transactionId").value =
                        existingPaymentData.transactionId
                    document.getElementById("transferDate").value =
                        existingPaymentData.transferDate
                    document.getElementById("transferTime").value =
                        existingPaymentData.transferTime
                    document.getElementById("recipientAccount").value =
                        existingPaymentData.recipientAccount
                    document.getElementById("amount").value =
                        existingPaymentData.amount
                    document.getElementById("additional").value =
                        existingPaymentData.additional
                }

                showMainForm()
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á
            function cancelAndRedirect() {
                // ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞ redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô
                alert("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô")
                window.history.back()
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏´‡∏•‡∏±‡∏Å
            function showMainForm() {
                document.getElementById("initialLoading").style.display = "none"
                document.getElementById("mainContainer").style.display = "block"

                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Transaction ID ‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
                if (transactionId) {
                    document.getElementById("transactionId").value =
                        transactionId
                }
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ file handlers
            function setupFileHandlers() {
                // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö
                document
                    .getElementById("attachment")
                    .addEventListener("change", function (e) {
                        const files = Array.from(e.target.files)
                        
                        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                        files.forEach(file => {
                            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
                            const isDuplicate = selectedFiles.some(existingFile => 
                                existingFile.name === file.name && existingFile.size === file.size
                            )
                            
                            if (!isDuplicate) {
                                selectedFiles.push(file)
                            }
                        })
                        
                        displayFiles()
                        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï input ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å
                        e.target.value = ""
                    })

                // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå
                const fileInput = document.querySelector(".file-input-label")

                fileInput.addEventListener("dragover", function (e) {
                    e.preventDefault()
                    this.style.backgroundColor = "#3c5a78"
                    this.style.borderColor = "#3498db"
                })

                fileInput.addEventListener("dragleave", function (e) {
                    e.preventDefault()
                    this.style.backgroundColor = "#34495e"
                    this.style.borderColor = "#4a5f7a"
                })

                fileInput.addEventListener("drop", function (e) {
                    e.preventDefault()
                    this.style.backgroundColor = "#34495e"
                    this.style.borderColor = "#4a5f7a"

                    const files = Array.from(e.dataTransfer.files)
                    
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                    files.forEach(file => {
                        const isDuplicate = selectedFiles.some(existingFile => 
                            existingFile.name === file.name && existingFile.size === file.size
                        )
                        
                        if (!isDuplicate) {
                            selectedFiles.push(file)
                        }
                    })
                    
                    displayFiles()
                })
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ form submission
            function setupFormSubmission() {
                // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
                document
                    .getElementById("paymentForm")
                    .addEventListener("submit", async function (e) {
                        e.preventDefault()

                        // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
                        const form = e.target
                        
                        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á
                        showLoading()

                        try {
                            let uploadedFiles = []
                            
                            // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                            if (selectedFiles.length > 0) {
                                const fileFormData = new FormData()
                                selectedFiles.forEach(file => {
                                    fileFormData.append("files", file)
                                })
                                
                                const uploadResponse = await fetch("/api/upload-attachment", {
                                    method: "POST",
                                    body: fileFormData
                                })
                                
                                if (uploadResponse.ok) {
                                    const uploadResult = await uploadResponse.json()
                                    if (uploadResult.success) {
                                        uploadedFiles = uploadResult.files
                                    }
                                }
                            }

                            // ‡∏™‡∏£‡πâ‡∏≤‡∏á JSON object ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                            const paymentData = {
                                account: form.account.value,
                                transactionId: form.transactionId.value,
                                transferDate: form.transferDate.value,
                                transferTime: form.transferTime.value,
                                recipientAccount: form.recipientAccount.value,
                                amount: parseFloat(form.amount.value),
                                additional: form.additional.value,
                                attachmentFiles: uploadedFiles // ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß
                            }

                            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                            const response = await fetch("/api/payment-notification", {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json"
                                },
                                body: JSON.stringify(paymentData)
                            })

                            const result = await response.json()

                            if (result.success) {
                                const fileInfo = uploadedFiles.length > 0 ? ` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏±‡∏ö ${uploadedFiles.length} ‡πÑ‡∏ü‡∏•‡πå` : ""
                                showResponse("success", result.message + fileInfo)
                                resetForm()
                            } else {
                                showResponse("error", result.message)
                            }

                        } catch (error) {
                            console.error("Error:", error)
                            showResponse("error", "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: " + error.message)
                        }

                        hideLoading()
                    })
            }
            async function fetchExistingPaymentData(transactionId) {
                try {
                    const response = await fetch(
                        `/api/payment-check/${transactionId}`
                    )
                    const data = await response.json()

                    if (response.ok && data.exists) {
                        return data.paymentData
                    }
                    return null
                } catch (error) {
                    console.error("Error checking existing payment:", error)
                    return null
                }
            }

            // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            let selectedFiles = []

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå
            function displayFiles() {
                const fileList = document.getElementById("fileList")
                const label = document.getElementById("fileLabel")

                fileList.innerHTML = ""

                if (selectedFiles.length === 0) {
                    label.textContent = "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå ‡∏´‡∏£‡∏∑‡∏≠ ‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)"
                    label.style.color = "#bdc3c7"
                    return
                }

                label.textContent = `üìé ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ${selectedFiles.length} ‡πÑ‡∏ü‡∏•‡πå`
                label.style.color = "#3498db"

                selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement("div")
                    fileItem.className = "file-item"

                    const fileName = document.createElement("span")
                    fileName.className = "file-name"
                    fileName.textContent = file.name

                    const fileSize = document.createElement("span")
                    fileSize.className = "file-size"
                    fileSize.textContent = formatFileSize(file.size)

                    const removeBtn = document.createElement("button")
                    removeBtn.className = "remove-file"
                    removeBtn.textContent = "√ó"
                    removeBtn.type = "button"
                    removeBtn.onclick = () => removeFile(index)

                    fileItem.appendChild(fileName)
                    fileItem.appendChild(fileSize)
                    fileItem.appendChild(removeBtn)

                    fileList.appendChild(fileItem)
                })
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå
            function removeFile(index) {
                selectedFiles.splice(index, 1)
                displayFiles()
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes'
                const k = 1024
                const sizes = ['Bytes', 'KB', 'MB', 'GB']
                const i = Math.floor(Math.log(bytes) / Math.log(k))
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]
            }

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö
            document
                .getElementById("attachment")
                .addEventListener("change", function (e) {
                    const files = Array.from(e.target.files)

                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                    files.forEach(file => {
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ
                        const isDuplicate = selectedFiles.some(existingFile =>
                            existingFile.name === file.name && existingFile.size === file.size
                        )

                        if (!isDuplicate) {
                            selectedFiles.push(file)
                        }
                    })

                    displayFiles()
                    // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï input ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å
                    e.target.value = ""
                })

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå
            const fileInput = document.querySelector(".file-input-label")

            fileInput.addEventListener("dragover", function (e) {
                e.preventDefault()
                this.style.backgroundColor = "#3c5a78"
                this.style.borderColor = "#3498db"
            })

            fileInput.addEventListener("dragleave", function (e) {
                e.preventDefault()
                this.style.backgroundColor = "#34495e"
                this.style.borderColor = "#4a5f7a"
            })

            fileInput.addEventListener("drop", function (e) {
                e.preventDefault()
                this.style.backgroundColor = "#34495e"
                this.style.borderColor = "#4a5f7a"

                const files = Array.from(e.dataTransfer.files)

                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                files.forEach(file => {
                    const isDuplicate = selectedFiles.some(existingFile =>
                        existingFile.name === file.name && existingFile.size === file.size
                    )

                    if (!isDuplicate) {
                        selectedFiles.push(file)
                    }
                })

                displayFiles()
            })

            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
            document
                .getElementById("paymentForm")
                .addEventListener("submit", async function (e) {
                    e.preventDefault()

                    // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
                    const form = e.target

                    // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á
                    showLoading()

                    try {
                        let uploadedFiles = []

                        // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                        if (selectedFiles.length > 0) {
                            const fileFormData = new FormData()
                            selectedFiles.forEach(file => {
                                fileFormData.append("files", file)
                            })

                            const uploadResponse = await fetch("/api/upload-attachment", {
                                method: "POST",
                                body: fileFormData
                            })

                            if (uploadResponse.ok) {
                                const uploadResult = await uploadResponse.json()
                                if (uploadResult.success) {
                                    uploadedFiles = uploadResult.files
                                }
                            }
                        }

                        // ‡∏™‡∏£‡πâ‡∏≤‡∏á JSON object ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                        const paymentData = {
                            account: form.account.value,
                            transactionId: form.transactionId.value,
                            transferDate: form.transferDate.value,
                            transferTime: form.transferTime.value,
                            recipientAccount: form.recipientAccount.value,
                            amount: parseFloat(form.amount.value),
                            additional: form.additional.value,
                            attachmentFiles: uploadedFiles // ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß
                        }

                        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                        const response = await fetch("/api/payment-notification", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify(paymentData)
                        })

                        const result = await response.json()

                        if (result.success) {
                            const fileInfo = uploadedFiles.length > 0 ? ` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö ${uploadedFiles.length} ‡πÑ‡∏ü‡∏•‡πå` : ""
                            showResponse("success", result.message + fileInfo)
                            resetForm()
                        } else {
                            showResponse("error", result.message)
                        }

                    } catch (error) {
                        console.error("Error:", error)
                        showResponse("error", "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: " + error.message)
                    }

                    hideLoading()
                })

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
            function resetForm() {
                document.getElementById("paymentForm").reset()
                selectedFiles = []
                displayFiles()
                hideLoading()
                hideResponse()
            }
                    // showResponse(
                    //     "success",
                    //     "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
                    // )

                    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á API
                    fetch("/api/payment-notification", {
                        method: "POST",
                        body: formData,
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                showResponse(
                                    "success",
                                    data.message ||
                                        "‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"
                                )
                            } else {
                                showResponse(
                                    "error",
                                    data.message ||
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
            function showLoading() {
                document.getElementById("loading").style.display = "block"
                document.getElementById("response").style.display = "none"
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            function showResponse(type, message) {
                const responseDiv = document.getElementById("response")
                responseDiv.className = `response ${type}`
                responseDiv.textContent = message
                responseDiv.style.display = "block"
                document.getElementById("loading").style.display = "none"
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
            function resetForm() {
                document.getElementById("paymentForm").reset()
                selectedFiles = []
                displayFiles()
                document.getElementById("response").style.display = "none"
                document.getElementById("loading").style.display = "none"
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á
            function hideResponse() {
                document.getElementById("response").style.display = "none"
            }

            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            }) // ‡∏õ‡∏¥‡∏î DOMContentLoaded event

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </script>
    </body>
</html>
